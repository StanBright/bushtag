<div class="text-center">
  <div class='focus-box-home'>
    <div id="map" style="width: 100%; height: 550px; background: grey" />
    <script  type="text/javascript" charset="UTF-8" >
      
      /* Map initialization code starts below: */

      // Step 1: initialize communication with the platform
      var platform = new H.service.Platform({
        app_id: "<%= ENV['HERE_API_ID'] %>",
        app_code: "<%= ENV['HERE_API_CODE'] %>",
        useHTTPS: true,
        useCIT: true
      });
      var defaultLayers = platform.createDefaultLayers();

      // Step 2: initialize a map
      var map = new H.Map(document.getElementById('map'), defaultLayers.normal.map, {
        center: new H.geo.Point(-32.789, 145.790),
        zoom: 5
      });

      // Step 3: make the map interactive
      // Behavior implements default interactions for pan/zoom (also on mobile touch environments)
      var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));

      // Step 4: create the default UI component, for displaying bubbles
      var ui = H.ui.UI.createDefault(map, defaultLayers);
      var data = <%= @animals_json.html_safe %>;

      startClustering(map, ui, getBubbleContent, data);
      //addPolylineToMap(map, polyData);
      
    </script>
  </div>
</div>
